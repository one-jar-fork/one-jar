<?xml version="1.0"?>
<project default="none">
	
	<target name="none"/>
		
	<macrodef name="one-jar-macro">
		<attribute name="destfile" default="one-jar.jar" />
		<attribute name="boot.manifest" />
		<attribute name="main.manifest" />
		<attribute name="main.classes" />
		<element name="main" />
		<element name="binlib" optional="true" />
		<element name="lib" optional="true" />
		<sequential>
			<tempfile prefix="one-jar-" property="tmp.dir" />
			<mkdir dir="${tmp.dir}/main" />
			<unjar dest="${tmp.dir}/one-jar" src="${one-jar-boot.jar}" />
			<jar destfile="${tmp.dir}/main/main.jar" manifest="@{main.manifest}">
				<fileset dir="${class.dir}">
					<include name="**/*.class" />
				</fileset>
			</jar>
			<jar destfile="@{destfile}" manifest="@{boot.manifest}">
				<fileset dir="${tmp.dir}">
					<include name="main/main.jar" />
				</fileset>
				<fileset dir="${tmp.dir}/one-jar">
					<include name="**/*.class" />
				</fileset>
				<binlib/>
				<lib/>
			</jar>
			<delete dir="${tmp.dir}"/>
			<echo>Created @{destfile}</echo>
		</sequential>
	</macrodef>

</project>